@model IEnumerable<ET.Sermons>

@using System.Globalization;

@{
    ViewBag.Title = "Sermones, Devocionales y otros";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}
<!-- From YouTube videos -->
@*<section class="hp-section">
    <div class="container">
        <div class="row justify-content-center border-bottom mb-2">
            <h2 class="heading-section font-weight-bold my-2 p-0">@ViewBag.Title</h2>
        </div>
        @foreach (var item in Model)
        {
            var VideoURL = "https://www.youtube.com/embed/" + item.id;
            var modalname = "ModalCenter" + item.id;
            <div class="row mb-5">
                <div class="justify-content-center my-auto">
                    <a class="img mb-3 d-flex justify-content-center align-items-center" style="background-image: url(@item.BannerLink); width: 10em; height:6em; border-radius: 10px;">
                        <div class="icon d-flex justify-content-center align-items-center">
                            <span class="far fa-play-circle fa-3x my-auto" data-toggle="modal" data-target='#@modalname' style="color: azure;"></span>
                        </div>
                    </a>
                </div>
                <div class="col-lg-10 pl-md-4 justify-content-start">
                    <h3 class="mb-2">
                        <a href="#">@item.Title</a>
                    </h3>
                    <div>
                        <p class="mb-2">
                            <span><i class="fas fa-calendar-alt mr-2"></i>@item.PublishedAt.ToString("MMMM dd, yyyy",new CultureInfo("es-US"))</span>
                        </p>
                    </div>
                    <p class="mb-2 justify-content-start">
                        @item.Description
                    </p>
                    <div class="mb-2 mt-2">
                        <div class="tagcloud">
                            <a>Amor</a>
                            <a>Fe</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal fade" id="@modalname">
                <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            <iframe src="@VideoURL" width="100%" height="315" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </div>

            <script src="~/Scripts/jquery-3.4.1.min.js"></script>
            <script src="~/Scripts/bootstrap.min.js"></script>
            <script type="text/javascript">

                $('#@modalname').on('hidden.bs.modal', function (e) {
                    $("#@modalname iframe").attr("src", $("#@modalname iframe").attr("src"));
                    });

            </script>
        }
    </div>
</section>*@

<section class="hp-section">
    <div class="container">
        <div class="row justify-content-center border-bottom mb-2">
            <h2 class="heading-section font-weight-bold my-2 p-0">@ViewBag.Title</h2>
        </div>
        @foreach (var item in Model)
        {
            var base64 = Convert.ToBase64String(item.BackgroundImage, 0, item.BackgroundImage.Length);
            var imgSrc = string.Format("data:image/{0};base64,{1}", item.BackgroundExt, base64);
            var text = imgSrc;
            var modalname = "ModalCenter" + item.SermonID.ToString();
            var tagListName = "TagList" + item.SermonID.ToString();


            <div class="row mb-5">
                <div class="justify-content-center my-auto">
                    <a class="img mb-3 d-flex justify-content-center align-items-center" style="background-image: url(@imgSrc); width: 10em; height:6em; border-radius: 10px;">
                        <div class="icon d-flex justify-content-center align-items-center">
                            <span class="far fa-play-circle fa-3x my-auto" data-toggle="modal" data-target='#@modalname' style="color: azure;"></span>
                        </div>
                    </a>
                </div>
                <div class="col-lg-10 pl-md-4 justify-content-start">
                    <h3 class="mb-2">
                        <a href="#">@item.Title</a>
                    </h3>
                    <div>
                        <p class="mb-2">
                            <span><i class="fas fa-calendar-alt mr-2"></i>@item.SermonDate.ToString("MMMM dd, yyyy", new CultureInfo("es-US"))</span>
                        </p>
                    </div>
                    <p class="mb-2 justify-content-start">
                        @item.Description
                    </p>
                    <div class="mb-2 mt-2">
                        <div id="@tagListName" class="tagcloud">
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="@modalname">
                <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            <iframe src="@item.SermonURL" width="100%" height="315" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </div>
   
            <script src="~/Scripts/jquery-3.4.1.min.js"></script>
            <script src="~/Scripts/bootstrap.min.js"></script>
            <script type="text/javascript">

                $('#@modalname').on('hidden.bs.modal', function (e) {
                    $("#@modalname iframe").attr("src", $("#@modalname iframe").attr("src"));
                });

                var tags = "@item.Tags";
                var array = tags.split(",")
                array.forEach(InsertValue);

                function InsertValue(item) {
                    var tagDiv = document.getElementById("@tagListName");
                    tagDiv.innerHTML += "<a>" + item + "</a>";
                }
            </script>
        }
    </div>
</section>
